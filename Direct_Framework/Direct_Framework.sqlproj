<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="4.0">
  <Sdk Name="Microsoft.Build.Sql" Version="2.0.0-preview.2" />
  <PropertyGroup>
    <!-- version definitions and reference dacpac names:
      https://github.com/microsoft/dacfx -->
    <Name>Direct_Framework</Name>
    <ProjectGuid>{b88ff268-22f9-4416-9e36-cfe598d243eb}</ProjectGuid>
    <DSP>Microsoft.Data.Tools.Schema.Sql.SqlAzureV12DatabaseSchemaProvider</DSP>
    <OutputType>Database</OutputType>
    <RootNamespace>Direct_Framework</RootNamespace>
    <AssemblyName>Direct_Framework</AssemblyName>
    <ModelCollation>1033,CS</ModelCollation>
    <DefaultFileStructure>BySchemaAndSchemaType</DefaultFileStructure>
    <!-- <DeployToDatabase>True</DeployToDatabase>
    <TargetFrameworkVersion>v4.8</TargetFrameworkVersion>
    <TargetLanguage>CS</TargetLanguage>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <SqlServerVerification>False</SqlServerVerification>
    <IncludeCompositeObjects>True</IncludeCompositeObjects>
    <TargetDatabaseSet>True</TargetDatabaseSet> -->
    <DefaultCollation>SQL_Latin1_General_CP1_CS_AS</DefaultCollation>
    <DefaultFilegroup>PRIMARY</DefaultFilegroup>
    <DacDescription>https://github.com/data-solution-automation-engine/DIRECT</DacDescription>
    <!-- <GenerateCreateScript>False</GenerateCreateScript> -->
    <IncludeSchemaNameInFileName>True</IncludeSchemaNameInFileName>
    <!-- <QueryStoreDesiredState>ReadWrite</QueryStoreDesiredState> -->
    <CompatibilityMode>160</CompatibilityMode>
    <RunSqlCodeAnalysis>True</RunSqlCodeAnalysis>
    <CodeAnalysisRules>-SqlServer.Rules.SRN0007;-SRN0007;-*.SRN0007;-Smells.*</CodeAnalysisRules>
  </PropertyGroup>
  <ItemGroup>
    <None Include="Stored Procedures\omd.EndDating.sql" />
    <None Include="DeploymentScripts\4-PostDacpacDeployment\PostDacpacDeployment.sql">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </None>
    <None Include="DeploymentScripts\1-PreDacpacDeployment\PreDacpacDeployment.sql">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </None>
    <None Include="DeploymentScripts\3-PostDeployment\Queue_Job_Module.sql" />
    <None Include="DeploymentScripts\3-PostDeployment\omd.BATCH.sql" />
    <None Include="DeploymentScripts\3-PostDeployment\omd.BATCH_INSTANCE.sql" />
    <None Include="DeploymentScripts\3-PostDeployment\omd.MODULE.sql" />
    <None Include="DeploymentScripts\3-PostDeployment\omd.MODULE_INSTANCE.sql" />
    <None Include="DeploymentScripts\3-PostDeployment\omd_metadata.AREA.sql" />
    <None Include="DeploymentScripts\3-PostDeployment\omd_metadata.EVENT_TYPE.sql" />
    <None Include="DeploymentScripts\3-PostDeployment\omd_metadata.EXECUTION_STATUS.sql" />
    <None Include="DeploymentScripts\3-PostDeployment\omd_metadata.LAYER.sql" />
    <None Include="DeploymentScripts\3-PostDeployment\omd_metadata.NEXT_RUN_STATUS.sql" />
    <None Include="DeploymentScripts\3-PostDeployment\omd_metadata.INTERNAL_PROCESSING_STATUS.sql" />
    <None Include="DeploymentScripts\3-PostDeployment\Queue_Job_Batch.sql" />
    <None Include="DeploymentScripts\3-PostDeployment\omd_metadata.FREQUENCY.sql" />
    <None Include="DeploymentScripts\3-PostDeployment\omd_metadata.FRAMEWORK_METADATA.sql" />
    <None Include="DeploymentScripts\3-PostDeployment\omd.MODULE_INSTANCE_EXECUTED_CODE.sql" />
    <None Include="DeploymentScripts\1-PreDacpacDeployment\Migrations\Migration-2.0.0.0.sql">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </None>
    <None Include="DeploymentScripts\1-PreDacpacDeployment\Migrations\Migration-1.9.2.0.sql">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </None>
    <None Include="DeploymentScripts\1-PreDacpacDeployment\Migrations\Migration-1.9.1.0.sql">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </None>
  </ItemGroup>
  <ItemGroup>
    <PostDeploy Include="DeploymentScripts\3-PostDeployment\Script.PostDeployment.sql" />
  </ItemGroup>
  <!-- <ItemGroup>
    <SqlCmdVariable Include="master">
      <DefaultValue>master</DefaultValue>
      <Value>$(SqlCmdVar__1)</Value>
    </SqlCmdVariable>
  </ItemGroup> -->
  <!-- <ItemGroup>
    <ArtifactReference Include="..\Reference_Databases\bin\Debug\master.dacpac">
      <HintPath>..\Reference_Databases\bin\Debug\master.dacpac</HintPath>
      <SuppressMissingDependenciesErrors>False</SuppressMissingDependenciesErrors>
      <DatabaseSqlCmdVariable>master</DatabaseSqlCmdVariable>
    </ArtifactReference>
  </ItemGroup> -->
  <ItemGroup>
    <PreDeploy Include="DeploymentScripts\2-PreDeployment\Script.PreDeployment.sql" />
  </ItemGroup>
  <ItemGroup>
    <None Include="DeploymentScripts\readme.md" />
    <None Include="BuildTools\PostBuild.cmd" />
    <None Include="BuildTools\PostBuild.ps1" />
    <None Include="BuildTools\PreBuild.cmd" />
    <None Include="BuildTools\PreBuild.ps1" />
  </ItemGroup>
  <ItemGroup>
    <PackageReference Include="ErikEJ.DacFX.SqlServer.Rules" Version="2.0.0">
      <IncludeAssets>runtime; build; native; contentfiles; analyzers; buildtransitive</IncludeAssets>
      <PrivateAssets>all</PrivateAssets>
    </PackageReference>
    <PackageReference Include="ErikEJ.DacFX.TSQLSmellSCA" Version="2.0.0">
      <IncludeAssets>runtime; build; native; contentfiles; analyzers; buildtransitive</IncludeAssets>
      <PrivateAssets>all</PrivateAssets>
    </PackageReference>
    <PackageReference Include="Microsoft.SqlServer.Dacpacs.Azure.Master">
      <Version>160.2.4</Version>
      <GeneratePathProperty>True</GeneratePathProperty>
      <DatabaseVariableLiteralValue>master</DatabaseVariableLiteralValue>
    </PackageReference>
  </ItemGroup>
  <ItemGroup>
    <Folder Include="Stored Procedures\" />
    <Folder Include="DeploymentScripts\" />
    <Folder Include="DeploymentScripts\4-PostDacpacDeployment\" />
    <Folder Include="DeploymentScripts\1-PreDacpacDeployment\" />
    <Folder Include="DeploymentScripts\3-PostDeployment\" />
    <Folder Include="DeploymentScripts\1-PreDacpacDeployment\Migrations\" />
    <Folder Include="DeploymentScripts\2-PreDeployment\" />
    <Folder Include="BuildTools\" />
  </ItemGroup>
  <!-- <ItemGroup>
    <PackageReference Include="Microsoft.NETFramework.ReferenceAssemblies" Condition="'$(NetCoreBuild)' == 'true'">
      <Version>1.0.0</Version>
      <PrivateAssets>All</PrivateAssets>
    </PackageReference>
  </ItemGroup> -->
  <Target Name="RunPreBuild" BeforeTargets="PreBuildEvent">
    <Exec Command="&quot;$(MSBuildProjectDirectory)/BuildTools/PreBuild.cmd&quot;" />
  </Target>
  <Target Name="RunPostBuild" AfterTargets="PostBuildEvent">
    <Exec Command="&quot;$(MSBuildProjectDirectory)/BuildTools/PostBuild.cmd&quot;" />
  </Target>
</Project>